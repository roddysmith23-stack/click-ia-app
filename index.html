<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAG.IA | Marketing Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <style>
        /* --- EST√âTICA "CELESTIAL TECH" V2 --- */
        :root {
            --sky-top: #E0F7FA;
            --sky-bottom: #FFFFFF;
            --orb-core: #00C6FF;
            --orb-glow: #0072FF;
            --glass: rgba(255, 255, 255, 0.85); /* M√°s opaco para mejor lectura */
            --glass-border: rgba(255, 255, 255, 0.9);
            --text-main: #0F172A;
            --accent: #2563EB;
        }

        body { 
            margin: 0; font-family: 'Space Grotesk', sans-serif; 
            background: linear-gradient(180deg, var(--sky-top) 0%, var(--sky-bottom) 100%);
            color: var(--text-main); height: 100vh; overflow: hidden;
        }

        /* ORBE MaG (El Avatar) */
        .mag-orb-container {
            position: relative; width: 120px; height: 120px; display: flex; justify-content: center; align-items: center;
            transition: all 0.5s ease;
        }
        .mag-core {
            width: 60px; height: 60px; background: var(--orb-core); border-radius: 50%;
            box-shadow: 0 0 30px var(--orb-glow), inset 0 0 20px white;
            animation: breathe 4s ease-in-out infinite; z-index: 10;
        }
        .mag-ring {
            position: absolute; border-radius: 50%; border: 1px solid rgba(0, 198, 255, 0.4);
            animation: spin 10s linear infinite;
        }
        .ring-1 { width: 90px; height: 90px; border-top-color: var(--orb-glow); animation-duration: 8s; }
        .ring-2 { width: 120px; height: 120px; border-bottom-color: var(--orb-glow); animation-direction: reverse; animation-duration: 12s; }

        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.9; } 50% { transform: scale(1.1); opacity: 1; box-shadow: 0 0 50px var(--orb-glow); } }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* MODO "GENERANDO" (Giro R√°pido) */
        .thinking .mag-core { animation: pulseFast 0.3s infinite alternate; background: #FF0080; box-shadow: 0 0 40px #FF0080; }
        .thinking .mag-ring { animation-duration: 0.5s; border-color: #FF0080; border-width: 2px; }
        @keyframes pulseFast { from { transform: scale(0.9); } to { transform: scale(1.15); } }

        /* CRISTAL UI MEJORADO */
        .glass-panel {
            background: var(--glass); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); box-shadow: 0 10px 40px rgba(37, 99, 235, 0.1);
        }

        /* NUBES */
        .cloud-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        .cloud {
            position: absolute; background: white; border-radius: 100px; opacity: 0.7; filter: blur(30px);
            animation: float linear infinite;
        }
        @keyframes float { from { transform: translateX(-100%) translateY(0); } to { transform: translateX(100vw) translateY(-20px); } }

        /* CARRUSEL INFINITO */
        .carousel-track { display: flex; gap: 16px; padding: 20px 40px; overflow-x: auto; scroll-behavior: smooth; }
        .carousel-track::-webkit-scrollbar { display: none; }
        .carousel-card { 
            min-width: 260px; height: 380px; border-radius: 24px; overflow: hidden; position: relative; 
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); border: 4px solid white;
        }
        .carousel-card:hover { transform: scale(1.02) translateY(-5px); z-index: 10; box-shadow: 0 25px 50px rgba(0,0,0,0.25); border-color: var(--accent); }

        /* CHAT BUBBLES */
        .bubble-user { background: #0F172A; color: white; border-radius: 20px 20px 0 20px; box-shadow: 0 5px 15px rgba(15, 23, 42, 0.2); }
        .bubble-mag { background: white; color: #0F172A; border-radius: 20px 20px 20px 0; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border: 1px solid rgba(255,255,255,0.8); }

        .typing-dot { width: 6px; height: 6px; background: #0F172A; border-radius: 50%; animation: type 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes type { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        
        /* AD OVERLAY (NUEVO) */
        .ad-overlay {
            position: fixed; inset: 0; z-index: 50; 
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .progress-bar { transition: width 1s linear; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ‚òÅÔ∏è BACKGROUND SYSTEM ---
        const Sky = () => {
            return (
                <div className="cloud-bg">
                    {[...Array(5)].map((_, i) => (
                        <div key={i} className="cloud" style={{
                            width: `${250 + Math.random() * 300}px`, height: `${120 + Math.random() * 100}px`,
                            top: `${Math.random() * 90}%`, left: `-${Math.random() * 30}%`,
                            animationDuration: `${40 + Math.random() * 40}s`, animationDelay: `-${Math.random() * 30}s`
                        }} />
                    ))}
                </div>
            );
        };

        // --- üîÆ MaG AVATAR ---
        const MaGOrb = ({ state }) => (
            <div className={`mag-orb-container ${state === 'thinking' ? 'thinking' : ''}`}>
                <div className="mag-ring ring-1"></div>
                <div className="mag-ring ring-2"></div>
                <div className="mag-core"></div>
            </div>
        );

        // --- üì∫ SPONSORED WAIT SCREEN (MONETIZACI√ìN) ---
        const AdBreak = ({ onFinish, duration = 3 }) => {
            const [timeLeft, setTimeLeft] = useState(duration);
            
            useEffect(() => {
                const interval = setInterval(() => {
                    setTimeLeft(prev => {
                        if (prev <= 1) { 
                            clearInterval(interval); 
                            setTimeout(onFinish, 500); // Peque√±o delay para suavizar la salida
                            return 0; 
                        }
                        return prev - 1;
                    });
                }, 1000);
                return () => clearInterval(interval);
            }, []);

            return (
                <div className="ad-overlay">
                    <div className="bg-white rounded-3xl p-1 max-w-sm w-full mx-6 shadow-2xl overflow-hidden relative">
                        {/* Etiqueta de Publicidad */}
                        <div className="absolute top-4 right-4 bg-gray-100 text-[9px] font-bold text-gray-500 px-2 py-1 rounded border border-gray-200">
                            ANUNCIO ‚Ä¢ {timeLeft}s
                        </div>

                        {/* Contenido del Anuncio (Simulado Google Ads) */}
                        <div className="p-8 pt-12 text-center">
                            <div className="w-16 h-16 bg-blue-100 rounded-2xl mx-auto mb-4 flex items-center justify-center text-3xl">‚òÅÔ∏è</div>
                            <h3 className="text-xl font-bold text-slate-900 mb-1">Google Cloud for Startups</h3>
                            <p className="text-sm text-slate-500 mb-6 font-medium">Escala tu infraestructura de IA sin l√≠mites. Cr√©ditos gratis para nuevos usuarios.</p>
                            
                            <button className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors text-sm">
                                M√°s Informaci√≥n
                            </button>
                        </div>

                        {/* Barra de Progreso de Espera */}
                        <div className="bg-gray-100 h-1.5 w-full mt-2">
                            <div 
                                className="h-full bg-blue-500 progress-bar" 
                                style={{ width: `${((duration - timeLeft) / duration) * 100}%` }}
                            ></div>
                        </div>
                    </div>
                    
                    <div className="mt-6 text-white/50 text-xs font-medium cursor-pointer hover:text-white transition-colors">
                        üîí P√°sate a PRO para saltar esperas
                    </div>
                </div>
            );
        };

        // --- üñºÔ∏è RESULT CAROUSEL ---
        const Carousel = ({ items }) => (
            <div className="w-full py-4">
                <div className="carousel-track">
                    {items.map((img, i) => (
                        <div key={i} className="carousel-card group">
                            <img src={img} className="w-full h-full object-cover" loading="lazy" />
                            <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-6">
                                <span className="text-white font-bold text-lg">Variaci√≥n {i+1}</span>
                                <div className="flex gap-2 mt-3">
                                    <button className="flex-1 bg-white text-black text-xs px-3 py-2.5 rounded-xl font-bold hover:bg-gray-200">Editar</button>
                                    <button className="flex-1 bg-blue-600 text-white text-xs px-3 py-2.5 rounded-xl font-bold hover:bg-blue-500 flex items-center justify-center gap-1">
                                        <svg className="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg> VEO Video
                                    </button>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        // --- üì± MAIN APP LOGIC ---
        const App = () => {
            const [isPro, setIsPro] = useState(false); // Toggle para simular PRO
            const [magState, setMagState] = useState('idle'); // idle, thinking
            const [messages, setMessages] = useState([
                { role: 'mag', type: 'text', content: "Hola Roddy. Marketing Cu√°ntico activado. ¬øQu√© vendemos hoy? üöÄ" }
            ]);
            const [input, setInput] = useState("");
            const [showAd, setShowAd] = useState(false);
            const [pendingPrompt, setPendingPrompt] = useState("");
            
            const scrollRef = useRef(null);

            // Auto-scroll inteligente
            useEffect(() => {
                if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
            }, [messages, magState]);

            const handleSend = (textOverride) => {
                const text = textOverride || input;
                if (!text.trim()) return;

                // 1. Mostrar mensaje del usuario
                setMessages(prev => [...prev, { role: 'user', type: 'text', content: text }]);
                setInput("");
                setMagState('thinking'); // Activar animaci√≥n del Orbe
                
                // 2. DECISI√ìN DE NEGOCIO (Ads vs Speed)
                if (!isPro) {
                    // USUARIO FREE: Mostrar Ad INMEDIATAMENTE (No esperar 1.5s)
                    setPendingPrompt(text);
                    setShowAd(true);
                } else {
                    // USUARIO PRO: Generaci√≥n Ultra-R√°pida (0.8s para efecto premium)
                    setTimeout(() => generateResponse(text), 800);
                }
            };

            const handleAdFinished = () => {
                setShowAd(false);
                // La generaci√≥n ocurre justo despu√©s del anuncio, se siente como "premio"
                generateResponse(pendingPrompt); 
            };

            const generateResponse = (prompt) => {
                // Generaci√≥n simulada de URLs (Pollinations AI)
                const seed = Math.floor(Math.random() * 1000);
                const fakeImages = [
                    `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt + " cinematic advertising shot 8k product photography")}?seed=${seed}&nologo=true`,
                    `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt + " futuristic neon cyberpunk background commercial")}?seed=${seed+1}&nologo=true`,
                    `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt + " minimalist luxury studio lighting clean")}?seed=${seed+2}&nologo=true`
                ];

                setMessages(prev => [
                    ...prev,
                    { role: 'mag', type: 'text', content: isPro ? "‚ö° Hecho a la velocidad de la luz. Mira esto:" : "Listo. Aqu√≠ tienes tus resultados optimizados:" },
                    { role: 'mag', type: 'carousel', content: fakeImages }
                ]);
                
                setMagState('idle');
            };

            const suggestions = [
                { label: "üëü Sneakers", prompt: "Zapatillas deportivas Nike futuristas flotando, fondo nubes ne√≥n, publicidad 8k" },
                { label: "üçî Food Porn", prompt: "Hamburguesa gourmet deliciosa con queso derretido, fotograf√≠a macro publicitaria, humo, iluminaci√≥n dram√°tica" },
                { label: "üèéÔ∏è Auto Lujo", prompt: "Coche deportivo rojo corriendo en t√∫nel de luz ne√≥n, estilo Cyberpunk, cinem√°tico" },
                { label: "üß¥ Cosm√©tica", prompt: "Botella de perfume de cristal sobre agua tranquila, piedras zen, luz suave natural, minimalista" }
            ];

            return (
                <div className="flex flex-col h-screen relative z-10">
                    <Sky />
                    
                    {/* TOP BAR */}
                    <header className="px-6 py-4 flex justify-between items-center glass-panel m-4 rounded-2xl z-20 shrink-0">
                        <div className="flex items-center gap-3">
                            <div className="w-9 h-9 rounded-xl bg-blue-600 flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/30">M</div>
                            <div>
                                <h1 className="font-bold tracking-tight text-lg leading-none">MAG.IA</h1>
                                <p className="text-[10px] font-medium text-slate-500 tracking-widest uppercase">Studio V2.0</p>
                            </div>
                        </div>
                        
                        {/* TOGGLE PRO (SIMULACI√ìN PARA RODDY) */}
                        <div className="flex items-center gap-3">
                            <button 
                                onClick={() => setIsPro(!isPro)}
                                className={`px-4 py-1.5 rounded-full text-[10px] font-bold tracking-wider transition-all border ${isPro ? 'bg-gradient-to-r from-amber-200 to-yellow-400 text-yellow-900 border-yellow-500 shadow-yellow-500/50 shadow-md' : 'bg-slate-100 text-slate-400 border-slate-200'}`}
                            >
                                {isPro ? '‚ö° PRO ACTIVADO' : 'üîí MODO FREE'}
                            </button>
                            <img src="roddy-ceo.jpg" className="w-9 h-9 rounded-full border-2 border-white shadow-sm object-cover" alt="Profile" />
                        </div>
                    </header>

                    {/* CHAT AREA */}
                    <main className="flex-1 overflow-y-auto px-2 pb-32 scroll-smooth" ref={scrollRef}>
                        <div className="flex flex-col items-center py-8 sticky top-0 z-0">
                            <MaGOrb state={magState} />
                            {messages.length === 1 && (
                                <p className="mt-6 text-sm text-slate-500 font-medium bg-white/40 px-4 py-1 rounded-full backdrop-blur-sm">
                                    {isPro ? "Sistema Cu√°ntico Listo (Sin Esperas)" : "Versi√≥n Gratuita (Con Ads)"}
                                </p>
                            )}
                        </div>

                        <div className="max-w-3xl mx-auto space-y-6 px-4 relative z-10">
                            {messages.map((msg, i) => (
                                <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'} animate-in slide-in-from-bottom-2 fade-in duration-500`}>
                                    {msg.type === 'text' ? (
                                        <div className={`px-6 py-4 max-w-[85%] text-[15px] font-medium leading-relaxed ${msg.role === 'user' ? 'bubble-user' : 'bubble-mag'}`}>
                                            {msg.content}
                                        </div>
                                    ) : (
                                        <Carousel items={msg.content} />
                                    )}
                                </div>
                            ))}
                            
                            {/* Indicador de "Escribiendo" solo si no hay Ad (o es Pro) */}
                            {magState === 'thinking' && !showAd && (
                                <div className="flex justify-start fade-in">
                                    <div className="bubble-mag px-5 py-4 flex gap-1.5 items-center">
                                        <span className="text-xs font-bold text-slate-400 mr-2">GENERANDO</span>
                                        <div className="typing-dot"></div>
                                        <div className="typing-dot"></div>
                                        <div className="typing-dot"></div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>

                    {/* INPUT COCKPIT */}
                    <div className="fixed bottom-0 left-0 w-full p-4 z-30 bg-gradient-to-t from-white/90 via-white/50 to-transparent pt-10">
                        <div className="max-w-2xl mx-auto">
                            {/* Suggestions */}
                            <div className="flex gap-2 mb-3 overflow-x-auto pb-2 scrollbar-hide mask-fade-sides">
                                {suggestions.map((s, i) => (
                                    <button 
                                        key={i} 
                                        onClick={() => handleSend(s.prompt)}
                                        className="whitespace-nowrap bg-white/90 hover:bg-white hover:scale-105 active:scale-95 backdrop-blur px-4 py-2.5 rounded-xl text-xs font-bold shadow-sm border border-blue-100 text-slate-700 transition-all"
                                    >
                                        {s.label}
                                    </button>
                                ))}
                            </div>

                            {/* Main Bar */}
                            <div className="glass-panel p-2 rounded-2xl flex items-center gap-2 shadow-2xl ring-1 ring-white/50">
                                <button className="w-11 h-11 rounded-xl bg-slate-50 text-slate-500 flex items-center justify-center hover:bg-slate-100 transition-colors">
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" /></svg>
                                </button>
                                
                                <input 
                                    type="text" 
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                                    placeholder="Describe tu idea maestra..." 
                                    className="flex-1 bg-transparent border-none outline-none text-base font-medium placeholder-slate-400 text-slate-800 h-11 px-2"
                                />
                                
                                <button className="w-11 h-11 rounded-xl text-slate-400 hover:text-slate-600 flex items-center justify-center transition-colors">
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg>
                                </button>

                                <button 
                                    onClick={() => handleSend()}
                                    className="w-11 h-11 rounded-xl bg-blue-600 text-white flex items-center justify-center shadow-lg hover:scale-105 active:scale-95 transition-all"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M5 12h14M12 5l7 7-7 7" /></svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* ADS MODAL */}
                    {showAd && <AdBreak onFinish={handleAdFinished} duration={3} />}

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

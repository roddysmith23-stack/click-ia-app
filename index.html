<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAG.IA - Transformation Gallery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;800&family=Outfit:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    
    <style>
        /* --- SISTEMA ATMOSF√âRICO DIN√ÅMICO (CEO SKY) --- */
        :root {
            --bg-gradient: linear-gradient(180deg, #0072ff 0%, #00c6ff 100%);
            --orb-color: rgba(255, 223, 0, 0.9); 
            --orb-shadow: 0 0 50px rgba(255, 200, 0, 0.8);
            --cloud-color: #FFFFFF;
            --cloud-shadow: rgba(255, 255, 255, 0.4);
            --star-opacity: 0;
            
            /* CRISTAL IOS REAL */
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-blur: 50px;
            --glass-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            
            --text-main: #FFFFFF;
            --text-contrast-bg: rgba(0, 0, 0, 0.25); 
            --accent: #38bdf8;
        }

        [data-theme='night'] {
            --bg-gradient: linear-gradient(180deg, #0f172a 0%, #312e81 100%);
            --orb-color: rgba(200, 200, 200, 0.3);
            --orb-shadow: 0 0 40px rgba(255, 255, 255, 0.2);
            --cloud-color: #64748b;
            --cloud-shadow: rgba(0, 0, 0, 0.5);
            --star-opacity: 1;
            --glass-bg: rgba(15, 23, 42, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-main: #F8FAFC;
            --text-contrast-bg: rgba(0, 0, 0, 0.4);
        }

        body { 
            margin: 0; overflow-x: hidden; font-family: 'Inter', sans-serif; 
            background: var(--bg-gradient); color: var(--text-main); 
            transition: background 1.5s ease; 
            min-height: 100vh; cursor: none; 
        }
        
        /* CURSOR */
        .cursor-orb {
            position: fixed; top: 0; left: 0; width: 40px; height: 40px;
            background: var(--orb-color); border-radius: 50%;
            transform: translate(-50%, -50%); pointer-events: none; z-index: 9999;
            box-shadow: var(--orb-shadow); filter: blur(8px);
            transition: background 0.5s ease; mix-blend-mode: screen;
        }
        .cursor-dot {
            position: fixed; top: 0; left: 0; width: 6px; height: 6px;
            background: white; border-radius: 50%;
            transform: translate(-50%, -50%); pointer-events: none; z-index: 10000;
        }

        /* UTILS */
        h1, h2, h3, .font-display { font-family: 'Outfit', sans-serif; text-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .font-body { font-family: 'Inter', sans-serif; }
        .readable-text { background: var(--text-contrast-bg); backdrop-filter: blur(4px); padding: 2px 8px; border-radius: 6px; display: inline-block; }
        .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.5); }

        /* CLOUDS */
        .sky-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; pointer-events: none; }
        .cloud { position: absolute; background: var(--cloud-color); border-radius: 100px; filter: blur(25px); opacity: 0.8; transition: background 1.5s ease; box-shadow: inset -10px -10px 30px var(--cloud-shadow); }
        .cloud::after, .cloud::before { content: ''; position: absolute; background: inherit; border-radius: 50%; }
        .cloud::after { width: 100px; height: 100px; top: -50px; left: 50px; }
        .cloud::before { width: 120px; height: 120px; top: -70px; right: 50px; }
        @keyframes floatCloud { 0% { transform: translateX(-120%); } 100% { transform: translateX(120vw); } }
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: radial-gradient(white 2px, transparent 2px); background-size: 50px 50px; opacity: var(--star-opacity); transition: opacity 1.5s ease; z-index: -2; }

        /* CRYSTAL UI */
        .crystal-card {
            background: var(--glass-bg); 
            backdrop-filter: blur(var(--glass-blur)); -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border); 
            box-shadow: var(--glass-shadow);
            border-radius: 32px; 
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .glass-input { 
            background: rgba(0, 0, 0, 0.15); border: 1px solid rgba(255,255,255,0.25); 
            color: #fff; font-family: 'Outfit', sans-serif; padding: 16px; width: 100%; border-radius: 16px; 
            transition: all 0.3s; backdrop-filter: blur(10px); font-weight: 500; text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        .glass-input:focus { outline: none; background: rgba(0, 0, 0, 0.3); border-color: rgba(255,255,255,0.6); }
        .glass-input::placeholder { color: rgba(255,255,255,0.7); }
        .glass-input.area { height: 100px; resize: none; }
        
        .tech-btn { 
            background: rgba(255, 255, 255, 0.95); color: #0f172a; font-family: 'Outfit', sans-serif; font-weight: 800; 
            border-radius: 99px; padding: 18px 40px; transition: all 0.3s; border: none; cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
        }
        .tech-btn:hover { transform: scale(1.05); box-shadow: 0 15px 40px rgba(0,0,0,0.3); background: #ffffff; }

        /* Golden Button */
        .gold-btn {
            background: linear-gradient(135deg, #FFD700 0%, #FDB931 100%);
            color: #5e4606; font-weight: 900; text-transform: uppercase; letter-spacing: 0.05em;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); border: 1px solid #FFF;
            animation: pulseGold 3s infinite;
        }
        .gold-btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        @keyframes pulseGold { 0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); } 50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.9); } 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); } }

        .header-stack { position: absolute; left: 50%; transform: translateX(-50%); top: 20px; display: flex; flex-direction: column; align-items: center; cursor: pointer; z-index: 30; width: max-content; }
        
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .back-arrow-btn {
            position: absolute; top: 24px; left: 24px; 
            width: 44px; height: 44px; border-radius: 50%;
            background: rgba(255,255,255,0.15); backdrop-filter: blur(15px);
            display: flex; items-center; justify-center;
            cursor: pointer; transition: all 0.2s;
            border: 1px solid rgba(255,255,255,0.3);
            z-index: 60;
        }
        .back-arrow-btn:hover { background: rgba(255,255,255,0.3); transform: scale(1.1); }

        .god-badge { background: linear-gradient(45deg, #FFD700, #FFA500); color: white; font-weight: 900; font-size: 10px; padding: 2px 8px; border-radius: 99px; box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); animation: pulseGod 2s infinite; }
        
        .slider-container { position: relative; width: 100%; height: 500px; border-radius: 32px; overflow: hidden; cursor: ew-resize; box-shadow: 0 25px 60px rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.4); transition: transform 0.3s; }
        .slider-container:hover { transform: scale(1.01); }

        /* Sparkle Button */
        .sparkle-btn { position: absolute; right: 10px; top: 10px; background: linear-gradient(135deg, #FFD700, #FFA500); color: #fff; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 0 10px rgba(255,215,0,0.5); animation: pulse 2s infinite; z-index: 10; border: none; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- 1. CONFIGURACI√ìN Y ASSETS ---
        // ‚ö†Ô∏è PEGA TU API KEY DE GEMINI AQU√ç ABAJO ENTRE LAS COMILLAS ‚ö†Ô∏è
        const apiKey = ""; 

        const CEO_PHOTO = "roddy-ceo.jpg";
        const CEO_EMAIL = "roddysmith23@hotmail.com";
        const CEO_PASS = "Yosoyarca1721383220*";
        
        // --- 2. L√ìGICA DE IA INTEGRADA (GEMINI) ---
        // Funci√≥n auxiliar para limpiar respuestas JSON de Gemini
        const cleanGeminiResponse = (text) => {
            return text.replace(/```json/g, '').replace(/```/g, '').trim();
        };

        const callGemini = async (prompt, isJson = false) => {
            if (!apiKey) {
                console.error("FALTA API KEY");
                alert("‚ö†Ô∏è ERROR: Falta la API Key de Gemini en el c√≥digo.");
                return null;
            }
            try {
                // Usando modelo standard Flash para velocidad
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: { responseMimeType: isJson ? "application/json" : "text/plain" }
                    })
                });
                const data = await response.json();
                
                if (!data.candidates || data.candidates.length === 0) {
                    throw new Error("Bloqueado por seguridad o error de API");
                }
                
                let text = data.candidates[0].content.parts[0].text;
                
                if (isJson) {
                    text = cleanGeminiResponse(text);
                    return JSON.parse(text);
                }
                return text;
            } catch (e) {
                console.error("Gemini Error", e);
                return null;
            }
        };

        // --- 3. DATA Y TRADUCCIONES ---
        const TRANSFORMATIONS = [
            {
                id: 'jordan',
                title: "Air Jordan 1 High",
                desc: "De foto casera a estudio profesional 8K con iluminaci√≥n dram√°tica.",
                before: 'IMG_8399.jpg',
                after: 'IMG_8401.jpg',
                tag: "CALZADO"
            },
            {
                id: 'burger',
                title: "Hamburguesa Gourmet",
                desc: "Transformaci√≥n a fotograf√≠a culinaria editorial con fondo r√∫stico.",
                before: 'https://image.pollinations.ai/prompt/A%20simple%20photo%20of%20a%20burger%20on%20a%20plain%20white%20plate%20on%20a%20kitchen%20counter?width=800&height=800&nologo=true&seed=101',
                after: 'https://image.pollinations.ai/prompt/A%20gourmet%20burger%20with%20melting%20cheese%20and%20bacon,%20cinematic%20lighting,%20dark%20rustic%20wood%20background,%20smoke,%208k%20food%20photography?width=800&height=800&nologo=true&seed=101',
                tag: "GASTRONOM√çA"
            },
            {
                id: 'watch',
                title: "Reloj Minimalista",
                desc: "Integraci√≥n de producto en un entorno de lujo y sofisticaci√≥n.",
                before: 'https://image.pollinations.ai/prompt/A%20simple%20product%20shot%20of%20a%20silver%20minimalist%20watch%20on%20a%20grey%20background?width=800&height=800&nologo=true&seed=202',
                after: 'https://image.pollinations.ai/prompt/A%20silver%20minimalist%20watch%20resting%20on%20dark%20marble,%20next%20to%20a%20glass%20of%20whiskey,%20soft%20warm%20luxury%20lighting,%20shallow%20depth%20of%20field?width=800&height=800&nologo=true&seed=202',
                tag: "LUJO"
            }
        ];

        const TRANSLATIONS = {
            ES: {
                nav_prices: "Precios", nav_login: "Ingresar", 
                hero_title: "El Futuro", hero_subtitle: "del Marketing", 
                hero_desc: "Calidad Profesional ‚Ä¢ Neuromarketing IA ‚Ä¢ Velocidad Luz", 
                cta_trial: "Prueba Gratis", cta_studio: "Abrir Magic Studio", swipe_hint: "Desliza para transformar",
                ceo_quote: '"Si para el universo no existen l√≠mites, no deber√≠a haber l√≠mites para la mente humana"',
                ceo_bio: "Roddy Smith, visionario estrat√©gico. Dominio total de la IA para cambiar el marketing global.",
                plan_basic_title: "Plan B√°sico", plan_basic_price: "$99", plan_basic_feat: "Solo Generaci√≥n de Im√°genes",
                plan_pro_title: "Plan Pro", plan_pro_price: "$399", plan_pro_feat: "Suite Completa + Magic Studio",
                plan_period: "/ mes", plan_year: "/ a√±o",
                empresa_btn: "Para Empresas", empresa_msg: "Deja tu contacto, Ventas te llamar√°.",
                studio_lock_msg: "Magic Studio (Capas) es solo para PRO.",
                promo_label: "C√≥digo Promotor", promo_ph: "EJ: RODDY20", pay_btn: "Confirmar Suscripci√≥n",
                trial_error: "¬°Ya usaste tus 3 cr√©ditos gratis!", trial_cta: "Suscr√≠bete para continuar.",
                login_title: "Acceso Seguro", login_btn: "Entrar",
                processing: "ANALIZANDO...", processing_step1: "FASE 1: Estratega de Marketing...", processing_step2: "FASE 2: Ejecutor Fotogr√°fico 8K...",
                q_title: "Dise√±a tu Campa√±a", q_prod: "Producto", q_prod_ph: "Ej: Zapatillas deportivas", q_target: "P√∫blico", q_target_ph: "Ej: J√≥venes urbanos", q_wish: "Tarjeta de Deseos (Opcional)", q_wish_ph: "Ej: Que est√© flotando en el espacio con luces ne√≥n", q_next: "Generar con IA",
                res_title: "Resultado IA", res_down: "Descargar HD",
                ai_suggestion: "‚ú® Idea Viral", ai_analyzing: "‚ú® Pensando...", chat_welcome: "Hola, soy ChatBoy. Preg√∫ntame sobre marketing o la app.",
                studio_title: "MAGIC STUDIO", studio_layer_bg: "Fondo (IA)", studio_layer_prod: "Producto (Tu Foto)", studio_layer_txt: "Texto/Overlay", studio_upscale: "UPSCALE 8K - $0.99",
                gallery_title: "Galer√≠a de Transformaciones"
            },
            EN: {
                nav_prices: "Pricing", nav_login: "Login", 
                hero_title: "The Future", hero_subtitle: "of Marketing", 
                hero_desc: "Professional Quality ‚Ä¢ AI Neuromarketing ‚Ä¢ Light Speed", 
                cta_trial: "Free Trial", cta_studio: "Open Magic Studio", swipe_hint: "Swipe to transform",
                ceo_quote: '"If there are no limits for the universe, there should be no limits for the human mind"',
                ceo_bio: "Roddy Smith, strategic visionary. Total mastery of AI to change global marketing.",
                plan_basic_title: "Basic Plan", plan_basic_price: "$99", plan_basic_feat: "Image Generation Only",
                plan_pro_title: "Pro Plan", plan_pro_price: "$399", plan_pro_feat: "Full Suite + Magic Studio",
                plan_period: "/ mo", plan_year: "/ year",
                empresa_btn: "For Enterprise", empresa_msg: "Leave contact, Sales will call.",
                studio_lock_msg: "Magic Studio (Layers) is for PRO only.",
                promo_label: "Promoter Code", promo_ph: "EX: RODDY20", pay_btn: "Confirm Subscription",
                trial_error: "Free credits used!", trial_cta: "Subscribe to continue.",
                login_title: "Secure Access", login_btn: "Login",
                processing: "ANALYZING...", processing_step1: "PHASE 1: Marketing Strategist...", processing_step2: "PHASE 2: 8K Photo Executor...",
                q_title: "Design Campaign", q_prod: "Product", q_prod_ph: "Ex: Sports sneakers", q_target: "Audience", q_target_ph: "Ex: Urban youth", q_wish: "Wish Card (Optional)", q_wish_ph: "Ex: Floating in space with neon lights", q_next: "Generate with AI",
                res_title: "AI Result", res_down: "Download HD",
                ai_suggestion: "‚ú® Viral Idea", ai_analyzing: "‚ú® Thinking...", chat_welcome: "Hi, I'm ChatBoy. Ask me about marketing or the app.",
                studio_title: "MAGIC STUDIO", studio_layer_bg: "Background (AI)", studio_layer_prod: "Product (Your Photo)", studio_layer_txt: "Text/Overlay", studio_upscale: "UPSCALE 8K - $0.99",
                gallery_title: "Transformation Gallery"
            },
            FR: {
                nav_prices: "Tarifs", nav_login: "Connexion", 
                hero_title: "Le Futur", hero_subtitle: "du Marketing", 
                hero_desc: "Qualit√© Professionnelle ‚Ä¢ Neuromarketing IA ‚Ä¢ Vitesse Lumi√®re", 
                cta_trial: "Essai Gratuit", cta_studio: "Ouvrir Magic Studio", swipe_hint: "Glissez pour transformer",
                ceo_quote: '"S\'il n\'y a pas de limites pour l\'univers, il ne devrait pas y avoir de limites pour l\'esprit humain"',
                ceo_bio: "Roddy Smith, visionnaire strat√©gique. Ma√Ætrise totale de l'IA pour changer le marketing mondial.",
                plan_basic_title: "Plan Basique", plan_basic_price: "99$", plan_basic_feat: "G√©n√©ration d'Images Seule",
                plan_pro_title: "Plan Pro", plan_pro_price: "399$", plan_pro_feat: "Suite Compl√®te + Magic Studio",
                plan_period: "/ mois", plan_year: "/ an",
                empresa_btn: "Pour Entreprises", empresa_msg: "Laissez contact, Ventes appellera.",
                studio_lock_msg: "Magic Studio (Calques) est exclusif aux membres PRO.",
                promo_label: "Code Promoteur", promo_ph: "EX: RODDY20", pay_btn: "Confirmer l'abonnement",
                trial_error: "Cr√©dits gratuits √©puis√©s !", trial_cta: "Abonnez-vous pour continuer.",
                login_title: "Acc√®s S√©curis√©", login_btn: "Entrer",
                processing: "ANALYSE...", processing_step1: "PHASE 1: Strat√®ge...", processing_step2: "PHASE 2: Ex√©cuteur 8K...",
                q_title: "D√©tails Campagne", q_prod: "Que vendez-vous?", q_prod_ph: "Ex: Baskets de sport", q_target: "Cible", q_target_ph: "Ex: Jeunes urbains", q_wish: "Carte de V≈ìux (Optionnel)", q_wish_ph: "Ex: Flottant dans l'espace avec n√©ons", q_next: "G√©n√©rer avec IA",
                res_title: "R√©sultat IA", res_down: "T√©l√©charger HD",
                ai_suggestion: "‚ú® Id√©e Virale", ai_analyzing: "‚ú® Pens√©e...", chat_welcome: "Bonjour, je suis ChatBoy. Posez-moi vos questions.",
                studio_title: "MAGIC STUDIO", studio_layer_bg: "Fond (IA)", studio_layer_prod: "Produit", studio_layer_txt: "Texte/Overlay", studio_upscale: "UPSCALE 8K - $0.99",
                gallery_title: "Galerie de Transformation"
            }
        };

        const Icons = {
            Sun: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
            Moon: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>,
            Message: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" /></svg>,
            Magic: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>,
            Check: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" /></svg>,
            Close: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
            User: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>,
            ArrowLeft: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>,
            Lock: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>,
            Sparkle: () => <svg className="w-3 h-3" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0L14.59 9.41L24 12L14.59 14.59L12 24L9.41 14.59L0 12L9.41 9.41L12 0Z"/></svg>,
            Layers: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
        };

        // --- COMPONENTES VISUALES ---
        const CelestialCursor = () => {
            const [pos, setPos] = useState({ x: -100, y: -100 });
            useEffect(() => {
                const move = (e) => {
                    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                    const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                    if (clientX) setPos({ x: clientX, y: clientY });
                };
                window.addEventListener('mousemove', move); window.addEventListener('touchmove', move);
                return () => { window.removeEventListener('mousemove', move); window.removeEventListener('touchmove', move); }
            }, []);
            return (
                <>
                    <div className="cursor-orb" style={{ left: pos.x, top: pos.y }}></div>
                    <div className="cursor-dot" style={{ left: pos.x, top: pos.y }}></div>
                </>
            );
        };

        const PixarSky = () => {
            const clouds = useRef([...Array(5)].map((_, i) => ({
                id: i, top: Math.random() * 50 + '%', width: 300 + Math.random() * 300 + 'px', height: 150 + Math.random() * 100 + 'px', duration: 60 + Math.random() * 40 + 's', delay: -Math.random() * 40 + 's', opacity: 0.8 + Math.random() * 0.2, scale: 0.8 + Math.random() * 0.6
            })));
            return (<div className="sky-container"><div className="stars"></div>{clouds.current.map(c => (<div key={c.id} className="cloud" style={{ top: c.top, width: c.width, height: c.height, left: '-20%', animation: `floatCloud ${c.duration} linear infinite`, animationDelay: c.delay, opacity: c.opacity, transform: `scale(${c.scale})` }}></div>))}</div>);
        };

        const NeuralBrain = () => {
            const canvasRef = useRef(null);
            useEffect(() => {
                const canvas = canvasRef.current; if (!canvas) return;
                const ctx = canvas.getContext('2d');
                let width = canvas.width = 300; let height = canvas.height = 300;
                let particles = [];
                for(let i=0; i<60; i++) particles.push({x: Math.random()*width, y: Math.random()*height, vx: (Math.random()-0.5)*2, vy: (Math.random()-0.5)*2});
                const animate = () => {
                    ctx.clearRect(0,0,width,height);
                    particles.forEach((p, i) => {
                        p.x += p.vx; p.y += p.vy;
                        if(p.x < 0 || p.x > width) p.vx *= -1; if(p.y < 0 || p.y > height) p.vy *= -1;
                        ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fillStyle = 'rgba(255,255,255,0.8)'; ctx.fill();
                        particles.slice(i+1).forEach(p2 => {
                            let d = Math.hypot(p.x-p2.x, p.y-p2.y);
                            if(d < 100) { ctx.beginPath(); ctx.strokeStyle = `rgba(255,255,255,${1 - d/100})`; ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke(); }
                        });
                    });
                    requestAnimationFrame(animate);
                };
                animate();
            }, []);
            return <canvas ref={canvasRef} className="w-48 h-48 mx-auto mb-6 bg-white/5 rounded-full backdrop-blur-md border border-white/20 shadow-2xl" />;
        };

        // --- COMPONENTES UI ---
        const ComparisonSlider = ({ beforeImg, afterImg }) => {
            const [sliderPos, setSliderPos] = useState(50);
            const containerRef = useRef(null);
            const handleMove = (e) => {
                if (!containerRef.current) return;
                const rect = containerRef.current.getBoundingClientRect();
                const clientX = e.clientX || (e.touches && e.touches[0].clientX); if (clientX === undefined) return;
                const x = (clientX - rect.left) / rect.width * 100; setSliderPos(Math.min(100, Math.max(0, x)));
            };
            return (
                <div className="slider-container" ref={containerRef} onMouseMove={handleMove} onTouchMove={handleMove}>
                    <img src={afterImg} className="absolute inset-0 w-full h-full object-cover" alt="Despu√©s" />
                    <div className="absolute inset-0 w-full h-full overflow-hidden border-r-4 border-white shadow-[0_0_30px_rgba(255,255,255,0.8)]" style={{ width: `${sliderPos}%` }}>
                        <img src={beforeImg} className="absolute inset-0 w-full h-full object-cover max-w-none" style={{ width: containerRef.current?.offsetWidth }} alt="Antes" />
                    </div>
                    <div className="absolute top-1/2 -translate-y-1/2 -translate-x-1/2 w-14 h-14 bg-white rounded-full shadow-2xl flex items-center justify-center text-slate-900 z-10 hover:scale-110 transition-transform" style={{ left: `${sliderPos}%` }}>
                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg>
                    </div>
                    <div className="absolute bottom-6 right-6 bg-black/60 backdrop-blur-md text-white px-4 py-1 rounded-full text-xs font-bold tracking-widest uppercase border border-white/20 pointer-events-none">AFTER</div>
                    <div className="absolute bottom-6 left-6 bg-white/80 backdrop-blur-md text-black px-4 py-1 rounded-full text-xs font-bold tracking-widest uppercase border border-white/20 pointer-events-none">BEFORE</div>
                </div>
            );
        };

        const PricingModal = ({ onClose, t, forcedMessage }) => {
            const [enterpriseMode, setEnterpriseMode] = useState(false);
            const [contactEmail, setContactEmail] = useState("");

            const handleEnterpriseSubmit = () => {
                if(contactEmail) {
                    alert(`Gracias. Hemos enviado tu solicitud a ${CEO_EMAIL}. Nuestro equipo de ventas te contactar√° pronto.`);
                    onClose();
                }
            };

            return (
                <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-lg p-4 fade-in">
                    <div className="crystal-card p-10 max-w-2xl w-full relative">
                        <div className="back-arrow-btn" onClick={onClose}><Icons.ArrowLeft /></div>
                        
                        {enterpriseMode ? (
                            <>
                                <h2 className="text-4xl font-display font-bold mb-4 text-center mt-4 text-shadow">{t.empresa_btn}</h2>
                                <p className="text-center text-sm mb-8 font-body opacity-90 text-shadow">{t.empresa_msg}</p>
                                <div className="space-y-4">
                                    <input className="glass-input" placeholder="Tu Correo Corporativo" value={contactEmail} onChange={e => setContactEmail(e.target.value)} />
                                    <textarea className="glass-input h-32" placeholder="Mensaje (Opcional)"></textarea>
                                    <button className="tech-btn w-full mt-4" onClick={handleEnterpriseSubmit}>ENVIAR A VENTAS</button>
                                    <button className="text-xs text-white/70 underline w-full text-center mt-2" onClick={() => setEnterpriseMode(false)}>Volver a Planes</button>
                                </div>
                            </>
                        ) : (
                            <>
                                <h2 className="text-4xl font-display font-bold mb-2 text-center mt-4 text-shadow">{t.nav_prices}</h2>
                                <p className="text-center text-sm mb-8 font-body opacity-90 text-shadow">{forcedMessage || "Elige tu poder."}</p>
                                <div className="grid md:grid-cols-2 gap-6">
                                    {/* PLAN B√ÅSICO */}
                                    <div className="bg-white/20 p-6 rounded-3xl border border-white/30 flex flex-col items-center backdrop-blur-md hover:scale-105 transition-transform">
                                        <h3 className="font-bold text-lg mb-2">{t.plan_basic_title}</h3>
                                        <span className="font-display font-bold text-4xl text-shadow">{t.plan_basic_price}</span>
                                        <span className="text-xs font-label opacity-80 mt-1 text-shadow">{t.plan_period}</span>
                                        <p className="text-xs mt-4 text-center opacity-90">{t.plan_basic_feat}</p>
                                        <button className="tech-btn w-full mt-4 text-xs">ELEGIR</button>
                                    </div>
                                    {/* PLAN PRO */}
                                    <div className="bg-blue-600/40 p-6 rounded-3xl border border-blue-400/50 flex flex-col items-center backdrop-blur-md hover:scale-105 transition-transform relative overflow-hidden">
                                        <div className="absolute top-0 right-0 bg-yellow-400 text-black text-[10px] font-bold px-3 py-1 rounded-bl-xl">RECOMENDADO</div>
                                        <h3 className="font-bold text-lg mb-2">{t.plan_pro_title}</h3>
                                        <span className="font-display font-bold text-4xl text-shadow">{t.plan_pro_price}</span>
                                        <span className="text-xs font-label opacity-80 mt-1 text-shadow">{t.plan_period}</span>
                                        <p className="text-xs mt-4 text-center opacity-90">{t.plan_pro_feat}</p>
                                        <button className="tech-btn w-full mt-4 text-xs bg-white text-blue-900">ELEGIR PRO</button>
                                    </div>
                                </div>
                                <div className="mt-6 pt-6 border-t border-white/20">
                                    <button onClick={() => setEnterpriseMode(true)} className="w-full glass-input text-center font-bold hover:bg-white/20 cursor-pointer">{t.empresa_btn}</button>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        };

        const LoginModal = ({ onClose, onLoginSuccess, t }) => {
            const [email, setEmail] = useState("");
            const [pass, setPass] = useState("");
            const handleSubmit = () => {
                if (email === CEO_EMAIL && pass === CEO_PASS) onLoginSuccess(true); else onLoginSuccess(false);
                onClose();
            };
            return (
                <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-lg p-4 fade-in">
                    <div className="crystal-card p-10 max-w-sm w-full relative">
                        <div className="back-arrow-btn" onClick={onClose}><Icons.ArrowLeft /></div>
                        <h2 className="text-3xl font-display font-bold mb-8 text-center mt-4 text-shadow flex justify-center items-center gap-2"><Icons.Lock /> {t.login_title}</h2>
                        <div className="space-y-5">
                            <input type="email" placeholder="Email" value={email} onChange={e => setEmail(e.target.value)} className="glass-input" />
                            <input type="password" placeholder="Password" value={pass} onChange={e => setPass(e.target.value)} className="glass-input" />
                            <button onClick={handleSubmit} className="tech-btn w-full">{t.login_btn}</button>
                        </div>
                        <div className="text-center mt-4 text-[10px] opacity-60 font-mono">SECURE ENCLAVE CONNECTION</div>
                    </div>
                </div>
            );
        };

        // --- CHATBOY (ASISTENTE VIRTUAL CON GEMINI) ---
        const ChatBoy = ({ t }) => {
            const [open, setOpen] = useState(false);
            const [msgs, setMsgs] = useState([{ role: 'bot', text: `ü§ñ ${t.chat_welcome || "Hola, soy ChatBoy. ¬øDudas sobre precios o funciones?"}` }]);
            const [input, setInput] = useState("");
            const [isLoading, setIsLoading] = useState(false);

            const handleSend = async () => {
                if(!input.trim()) return;
                const userMsg = { role: 'user', text: input };
                setMsgs(prev => [...prev, userMsg]);
                setInput("");
                setIsLoading(true);
                
                const prompt = `Eres ChatBoy, el asistente virtual experto en marketing de la app MAG.IA. Responde de forma breve y √∫til a: "${input}". Si preguntan precios: Plan B√°sico $99, Pro $399. Si preguntan funciones: Generaci√≥n de im√°genes con IA, Neuromarketing y Magic Studio.`;
                const aiReply = await callGemini(prompt);
                
                setIsLoading(false);
                setMsgs(prev => [...prev, { role: 'bot', text: aiReply || "Lo siento, estoy procesando demasiados datos. Intenta de nuevo." }]);
            };

            return (
                <div className="fixed bottom-8 right-8 z-[90] flex flex-col items-end">
                    {open && (
                        <div className="mb-4 w-80 crystal-card p-5 fade-in origin-bottom-right shadow-2xl bg-black/40 border-white/40 backdrop-blur-xl">
                            <div className="flex justify-between items-center mb-4 pb-2 border-b border-white/20">
                                <h4 className="font-bold text-sm flex items-center gap-2 text-shadow">CHATBOY <span className="text-[10px] bg-blue-500 px-1 rounded">AI</span></h4>
                                <button onClick={() => setOpen(false)}><Icons.Close /></button>
                            </div>
                            <div className="h-64 bg-white/10 rounded-xl mb-4 p-4 text-sm font-body overflow-y-auto flex flex-col gap-3">
                                {msgs.map((m, i) => (
                                    <div key={i} className={`p-3 rounded-lg max-w-[80%] ${m.role === 'bot' ? 'bg-white/20 self-start rounded-tl-none' : 'bg-blue-500/50 self-end rounded-tr-none'}`}>
                                        <p className="text-shadow">{m.text}</p>
                                    </div>
                                ))}
                                {isLoading && <div className="text-xs opacity-50 animate-pulse">Escribiendo...</div>}
                            </div>
                            <div className="flex gap-2">
                                <input className="glass-input py-3 text-sm" placeholder="..." value={input} onChange={e => setInput(e.target.value)} onKeyPress={e => e.key === 'Enter' && handleSend()} />
                                <button onClick={handleSend} className="p-3 bg-white/20 rounded-xl hover:bg-white/40"><Icons.Message /></button>
                            </div>
                        </div>
                    )}
                    <button onClick={() => setOpen(!open)} className="tech-btn w-16 h-16 rounded-full flex items-center justify-center p-0 shadow-2xl hover:scale-110 transition-transform">
                        <Icons.Message />
                    </button>
                </div>
            );
        };

        // --- HEADER ---
        const Header = ({ setView, theme, toggleTheme, user, onOpenLogin, onShowPricing, lang, setLang }) => (
            <div className="w-full h-28 relative z-50 px-8 flex items-center justify-between">
                <div className="flex items-center gap-4 w-1/3">
                    <div className="crystal-card px-2 py-1 flex items-center gap-1 shadow-sm bg-white/20 backdrop-blur-md">
                        {['ES', 'EN', 'FR'].map(l => ( 
                            <button key={l} onClick={() => setLang(l)} className={`text-[10px] font-bold font-label px-3 py-1.5 rounded-full transition-all ${lang === l ? 'bg-black text-white' : 'text-white/70 hover:text-white'}`}>{l}</button> 
                        ))}
                    </div>
                    <button onClick={onShowPricing} className="glass-input px-6 py-3 text-xs font-bold w-auto hover:bg-white/30 cursor-pointer text-shadow hidden md:block">PRECIOS</button>
                </div>
                <div className="header-stack group w-1/3 flex justify-center" onClick={() => setView('landing')}>
                    <h1 className="text-6xl font-display font-black tracking-tight text-center leading-none drop-shadow-2xl text-shadow cursor-pointer transform hover:scale-105 transition-transform">MAG.IA</h1>
                    <div className="readable-text text-[9px] font-label text-center tracking-[0.3em] mt-2 font-bold uppercase">Potenciado por Google Gemini</div>
                </div>
                <div className="flex items-center gap-4 w-1/3 justify-end">
                    <button onClick={toggleTheme} className="w-12 h-12 rounded-full bg-white/10 backdrop-blur flex items-center justify-center border border-white/20 hover:bg-white/30 transition-all">
                        {theme === 'day' ? <Icons.Sun /> : <Icons.Moon />}
                    </button>
                    {!user ? (
                        <button onClick={onOpenLogin} className="glass-input px-6 py-3 text-xs font-bold w-auto hover:bg-white/30 cursor-pointer flex gap-2 items-center text-shadow">
                            <Icons.User /> INGRESAR
                        </button>
                    ) : (
                        <div className="flex items-center gap-2">
                            <img src={user.avatar} className="w-12 h-12 rounded-full border-2 border-white shadow-lg" />
                            {user.isGod && <span className="god-badge">GOD</span>}
                        </div>
                    )}
                </div>
            </div>
        );

        // --- VIEWS ---
        const QuestionView = ({ t, onNext, setUserData }) => {
            const [prod, setProd] = useState("");
            const [target, setTarget] = useState("");
            const [wish, setWish] = useState("");
            const [suggesting, setSuggesting] = useState(false);

            const handleSuggest = async () => {
                setSuggesting(true);
                const idea = await callGemini("Eres un experto en tendencias. Dame UNA sola idea de producto viral breve (ej: 'Zapatillas Ne√≥n Retro'). Solo el texto.");
                if(idea) setProd(idea.replace(/"/g, '').trim());
                setSuggesting(false);
            };

            const handleNext = () => {
                if(!prod || !target) { alert("Completa los campos Producto y P√∫blico"); return; }
                setUserData({ prod, target, wish });
                onNext();
            };

            return (
                <div className="fixed inset-0 z-40 flex items-center justify-center p-4 fade-in">
                    <div className="crystal-card p-10 max-w-2xl w-full text-center relative">
                        <div className="back-arrow-btn" onClick={() => window.location.reload()}><Icons.ArrowLeft /></div>
                        <h2 className="text-3xl font-display font-bold mb-8 text-shadow">{t.q_title}</h2>
                        
                        <div className="space-y-5 text-left">
                            <div className="relative">
                                <label className="font-label ml-2 mb-1 block text-shadow">{t.q_prod}</label>
                                <input className="glass-input" placeholder={t.q_prod_ph} value={prod} onChange={e => setProd(e.target.value)} />
                                <button className="absolute right-2 top-8 text-xs bg-white/20 px-2 py-1 rounded hover:bg-white/40 transition-colors flex items-center gap-1" onClick={handleSuggest}>
                                    {suggesting ? t.ai_analyzing : t.ai_suggestion} <Icons.Sparkle />
                                </button>
                            </div>
                            <div><label className="font-label ml-2 mb-1 block text-shadow">{t.q_target}</label><input className="glass-input" placeholder={t.q_target_ph} value={target} onChange={e => setTarget(e.target.value)} /></div>
                            <div><label className="font-label ml-2 mb-1 block text-shadow">{t.q_wish}</label><textarea className="glass-input area" placeholder={t.q_wish_ph} value={wish} onChange={e => setWish(e.target.value)} /></div>
                        </div>
                        <button onClick={handleNext} className="tech-btn w-full mt-8 text-lg shadow-lg">{t.q_next}</button>
                    </div>
                </div>
            );
        };

        // --- ‚ö°Ô∏è CEREBRO CENTRAL REPARADO (2 FASES) ---
        const ProcessingView = ({ onFinish, t, userData }) => {
            const [step, setStep] = useState(0);

            useEffect(() => {
                const process = async () => {
                    try {
                        // üü¢ FASE 1: EL ESTRATEGA (PROMPT MAESTRO 1)
                        setStep(1);
                        const strategistPrompt = `Act√∫a como Director de Marketing. Analiza: Producto ${userData.prod} y Target ${userData.target}. Si hay deseo del cliente: ${userData.wish}.
                        Devuelve SOLO un objeto JSON con este formato estricto:
                        {
                          "strategy_summary": "Resumen de la estrategia en 1 frase",
                          "color_palette": "Lista de colores (ej: Ne√≥n Blue, Dark Grey)",
                          "lighting_setup": "Tipo de iluminaci√≥n (ej: Cinematic Rim Light)",
                          "viral_copy": "Texto persuasivo para redes",
                          "visual_concept": "Descripci√≥n conceptual de la imagen"
                        }`;
                        
                        const strategyData = await callGemini(strategistPrompt, true);
                        if(!strategyData) throw new Error("Fallo en Fase 1");
                        
                        // üü¢ FASE 2: EL EJECUTOR (PROMPT MAESTRO 2)
                        setStep(2);
                        await new Promise(r => setTimeout(r, 1500)); // Peque√±a pausa dram√°tica
                        
                        const executorPrompt = `Act√∫a como Fot√≥grafo 8K y Artista 3D.
                        Basado en este concepto: "${strategyData.visual_concept}" e iluminaci√≥n "${strategyData.lighting_setup}".
                        Escribe un PROMPT T√âCNICO EN INGL√âS para generar la imagen con IA.
                        Debe incluir: "8k, octane render, photorealistic, --no text".
                        NO incluyas explicaciones, SOLO el prompt en ingl√©s.`;
                        
                        const technicalPrompt = await callGemini(executorPrompt, false);
                        
                        // üèÅ FINALIZAR
                        const finalResult = {
                            ...strategyData,
                            technical_prompt: technicalPrompt
                        };
                        
                        onFinish(finalResult);

                    } catch(err) {
                        console.error(err);
                        alert("Error en el proceso neuronal. Verifica tu API Key o conexi√≥n.");
                        window.location.reload();
                    }
                };
                process();
            }, []);

            return (
                <div className="fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/60 backdrop-blur-xl fade-in">
                    <NeuralBrain />
                    <h2 className="text-4xl font-display font-bold mt-6 animate-pulse text-shadow">{t.processing}</h2>
                    <p className="text-sm opacity-90 mt-3 font-mono text-shadow bg-black/20 px-4 py-1 rounded-full">
                        {step === 0 ? "Iniciando Motor..." : step === 1 ? t.processing_step1 : t.processing_step2}
                    </p>
                </div>
            );
        };

        const MagicStudio = ({ t, onClose, aiData, userData }) => {
            const [imageUrl, setImageUrl] = useState("https://image.pollinations.ai/prompt/loading");
            const canvasRef = useRef(null);
            
            useEffect(() => {
                // Generar Imagen Final usando el Prompt T√©cnico de la Fase 2
                if (aiData?.technical_prompt) {
                    const encodedPrompt = encodeURIComponent(aiData.technical_prompt);
                    const finalUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?nologo=true&width=1024&height=1024&seed=${Math.floor(Math.random()*1000)}`;
                    setImageUrl(finalUrl);
                }

                // Iniciar Canvas (Fabric.js)
                if (canvasRef.current) {
                    const canvas = new fabric.Canvas(canvasRef.current, { width: 800, height: 800, backgroundColor: 'transparent' });
                    // Solo un placeholder de texto para simular capa de usuario
                    const productText = new fabric.Text(userData.prod || "PRODUCTO", { 
                        left: 250, top: 300, fontSize: 60, fill: 'white', fontFamily: 'Outfit', fontWeight: 'bold',
                        shadow: 'rgba(0,0,0,0.5) 5px 5px 10px'
                    });
                    canvas.add(productText);
                }
            }, [aiData]);

            return (
                <div className="fixed inset-0 z-40 flex items-center justify-center p-4 fade-in">
                    <div className="crystal-card w-full h-[90vh] max-w-7xl flex overflow-hidden relative border-2 border-white/20">
                        <div className="back-arrow-btn" onClick={onClose}><Icons.ArrowLeft /></div>
                        
                        {/* Canvas Area */}
                        <div className="flex-1 bg-black/40 flex items-center justify-center p-10 relative">
                            <div className="h-[600px] w-[600px] relative shadow-2xl bg-gray-900 rounded-xl overflow-hidden">
                                {/* Layer 0: AI Generated Image */}
                                <img src={imageUrl} className="absolute inset-0 w-full h-full object-cover" alt="AI Generated" />
                                {/* Layer 1+: Fabric Canvas */}
                                <div className="absolute inset-0 w-full h-full z-10">
                                    <canvas ref={canvasRef} />
                                </div>
                                <div className="absolute bottom-4 right-4 gold-btn px-6 py-3 rounded-full text-xs cursor-pointer shadow-lg hover:scale-105 transition-transform flex items-center gap-2 z-20">
                                    <Icons.Sparkle /> {t.studio_upscale}
                                </div>
                            </div>
                        </div>

                        {/* Sidebar Layers */}
                        <div className="w-80 bg-white/10 backdrop-blur-xl border-l border-white/20 p-6 flex flex-col gap-6 overflow-y-auto">
                            <div className="text-xl font-display font-bold text-shadow border-b border-white/20 pb-4">{t.studio_title}</div>
                            
                            <div className="flex flex-col gap-3">
                                <div className="text-xs font-label opacity-70">CAPAS</div>
                                <div className="bg-white/5 p-3 rounded-lg border border-white/10 flex justify-between items-center cursor-pointer hover:bg-white/10">
                                    <span className="text-sm">{t.studio_layer_bg}</span>
                                    <span className="text-[10px] bg-blue-500 px-1 rounded">AI</span>
                                </div>
                            </div>

                            <div className="bg-black/20 p-4 rounded-xl mt-4 border border-white/10">
                                <div className="text-xs font-bold text-yellow-400 mb-2">üí° COPY NEUROMARKETING:</div>
                                <p className="text-xs italic opacity-80 leading-relaxed">"{aiData?.viral_copy || 'Generando copy...'}"</p>
                            </div>
                            
                            <div className="bg-black/20 p-4 rounded-xl border border-white/10">
                                <div className="text-xs font-bold text-blue-300 mb-2">üé® PALETA DE COLORES:</div>
                                <p className="text-xs italic opacity-80 leading-relaxed">{aiData?.color_palette || 'Calculando...'}</p>
                            </div>

                            <button className="tech-btn w-full text-xs mt-auto">{t.res_down}</button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- APP MAIN ---
        const App = () => {
            const [view, setView] = useState('landing');
            const [theme, setTheme] = useState('day');
            const [lang, setLang] = useState('ES');
            const [user, setUser] = useState(null);
            const [showPricing, setShowPricing] = useState(false);
            const [showLogin, setShowLogin] = useState(false);
            const [credits, setCredits] = useState(3);
            const [pricingMsg, setPricingMsg] = useState("");
            const [userData, setUserData] = useState({});
            const [aiData, setAiData] = useState(null);
            const [selectedTransformIndex, setSelectedTransformIndex] = useState(0);

            useEffect(() => { document.body.setAttribute('data-theme', theme); }, [theme]);
            const toggleTheme = () => setTheme(prev => prev === 'day' ? 'night' : 'day');
            const t = TRANSLATIONS[lang];

            const handleStartTrial = () => {
                if (user?.isGod) { setView('questions'); return; }
                if (credits <= 0) { setPricingMsg(t.trial_error); setShowPricing(true); } 
                else { 
                    setCredits(prev => prev - 1); 
                    setView('questions'); 
                }
            };

            const activeTransform = TRANSFORMATIONS[selectedTransformIndex];

            return (
                <>
                    <PixarSky />
                    <CelestialCursor />
                    
                    <div className="relative z-10 min-h-screen flex flex-col">
                        <Header setView={setView} theme={theme} toggleTheme={toggleTheme} user={user} onOpenLogin={() => setShowLogin(true)} onShowPricing={() => setShowPricing(true)} lang={lang} setLang={setLang} />
                        
                        {view === 'landing' && (
                            <main className="flex-1 flex flex-col items-center justify-center px-4 text-center mt-10 mb-20 fade-in cursor-default relative z-20">
                                <h2 className="text-7xl md:text-9xl font-display font-black mb-4 tracking-tighter leading-none drop-shadow-2xl text-shadow">
                                    {t.hero_title} <br/><span style={{color: 'rgba(255,255,255,0.9)'}}>{t.hero_subtitle}</span>
                                </h2>
                                <div className="readable-text mb-16">
                                    <p className="font-label text-sm tracking-[0.3em] font-bold">{t.hero_desc}</p>
                                </div>
                                
                                <div className="w-full max-w-5xl mb-12 crystal-card p-4 relative">
                                    <h3 className="text-2xl font-display font-bold mb-4 text-shadow text-left pl-4 flex items-center gap-3">
                                        {activeTransform.title}
                                        <span className="text-[10px] bg-blue-500/80 px-2 py-1 rounded-full font-mono uppercase tracking-wider">{activeTransform.tag}</span>
                                    </h3>
                                    <ComparisonSlider beforeImg={activeTransform.before} afterImg={activeTransform.after} />
                                     <p className="text-sm text-left pl-4 mt-4 opacity-80 italic">"{activeTransform.desc}"</p>
                                </div>

                                <div className="w-full max-w-5xl grid grid-cols-3 gap-4 mb-24 px-4">
                                    {TRANSFORMATIONS.map((item, index) => (
                                        <div key={item.id} onClick={() => setSelectedTransformIndex(index)}
                                             className={`crystal-card p-2 cursor-pointer transition-all hover:scale-105 ${index === selectedTransformIndex ? 'border-blue-400/80 bg-blue-500/20' : 'border-white/20'}`}>
                                            <div className="relative h-24 rounded-2xl overflow-hidden mb-2">
                                                <img src={item.after} className="w-full h-full object-cover" />
                                                <div className="absolute bottom-0 left-0 right-0 bg-black/50 text-[9px] p-1 text-center font-bold truncate">{item.title}</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                <div className="flex gap-6 mb-24">
                                    <button onClick={handleStartTrial} className="tech-btn text-lg">{t.cta_trial} ({user?.isGod ? '‚àû' : credits})</button>
                                    <button onClick={() => { if(user?.isGod) alert("GOD MODE: STUDIO UNLOCKED"); else { setPricingMsg(t.studio_lock_msg); setShowPricing(true); } }} className="glass-input w-auto px-10 py-4 font-bold uppercase tracking-widest cursor-pointer hover:bg-white/20 text-shadow border-2 border-white/40">
                                        {t.cta_studio}
                                    </button>
                                </div>

                                <div className="w-full max-w-4xl crystal-card p-12 mb-20 flex flex-col md:flex-row items-center gap-12 text-left">
                                    <div className="w-48 h-48 rounded-full border-4 border-white/30 shadow-2xl flex-shrink-0 overflow-hidden">
                                        <img src={CEO_PHOTO} className="w-full h-full object-cover" />
                                    </div>
                                    <div>
                                        <div className="readable-text mb-4"><span className="font-label text-xs">CREATOR</span></div>
                                        <h3 className="text-4xl font-display font-bold mb-2 text-shadow">RODDY SMITH</h3>
                                        <p className="text-xl italic font-light opacity-90 border-l-4 border-white/50 pl-6 text-shadow">{t.ceo_quote}</p>
                                    </div>
                                </div>
                            </main>
                        )}

                        {view === 'questions' && <QuestionView t={t} onNext={() => setView('processing')} setUserData={setUserData} />}
                        {view === 'processing' && <ProcessingView t={t} userData={userData} onFinish={(data) => { setAiData(data); setView('studio'); }} />}
                        {view === 'studio' && <MagicStudio t={t} aiData={aiData} userData={userData} onClose={() => setView('landing')} />}
                    </div>

                    {showLogin && <LoginModal onClose={() => setShowLogin(false)} onLoginSuccess={(isGod) => setUser({ name: "Roddy", avatar: CEO_PHOTO, isGod })} t={t} />}
                    {showPricing && <PricingModal onClose={() => setShowPricing(false)} t={t} forcedMessage={pricingMsg} />}
                    <ChatBoy t={t} />
                </>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
